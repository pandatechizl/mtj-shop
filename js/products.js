// products.js
const products = [
  {
    id: 1,
    name: "Gold Charm Necklace",
    price: 2200,
    description: "Gold necklace with leaf charm",
    imageUrl: "assets/images/gold_chain_necklace.webp",
    category: "newArrival",
    details: {
      item: "Necklace",
      color: "Yellow Gold",
      size: "18 inches",
      weight: "15g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 2,
    name: "Minimalist Bracelet",
    price: 1400,
    description: "Simple bracelet for daily wear",
    imageUrl: "assets/images/minimalist_bracelet.webp",
    category: "newArrival",
    details: {
      item: "Bracelet",
      color: "Yellow Gold",
      size: "10 inches",
      weight: "7g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 3,
    name: "Pearl Drop Earrings",
    price: 1800,
    description: "Elegant pearl drop earrings",
    imageUrl: "assets/images/pearldropears.webp",
    category: "newArrival",
    details: {
      item: "Earring",
      color: "Yellow Gold",
      size: "0.8 inches",
      weight: "7g",
      stones: "Natural Pearl",
      material: "18K Gold"
      }
  },
  {
    id: 4,
    name: "Stackable Rings Set",
    price: 1600,
    description: "Gold-plated rings set",
    imageUrl: "assets/images/stackingring.webp",
    category: "newArrival",
    details: {
      item: "Ring",
      color: "Yellow Gold",
      size: "10",
      weight: "3g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 5,
    name: "Gold Charm Necklace",
    price: 2200,
    description: "Gold necklace with leaf charm",
    imageUrl: "assets/images/gold_chain_necklace.webp",
    category: "newArrival",
    details: {
      item: "Necklace",
      color: "Yellow Gold",
      size: "18 inches",
      weight: "15g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 6,
    name: "Minimalist Bracelet",
    price: 1400,
    description: "Simple bracelet for daily wear",
    imageUrl: "assets/images/minimalist_bracelet.webp",
    category: "newArrival",
    details: {
      item: "Bracelet",
      color: "Yellow Gold",
      size: "10 inches",
      weight: "7g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 7,
    name: "Pearl Drop Earrings",
    price: 1800,
    description: "Elegant pearl drop earrings",
    imageUrl: "assets/images/pearldropears.webp",
    category: "newArrival",
    details: {
      item: "Earring",
      color: "Yellow Gold",
      size: "0.8 inches",
      weight: "7g",
      stones: "Natural Pearl",
      material: "18K Gold"
      }
  },
  {
    id: 8,
    name: "Stackable Rings Set",
    price: 1600,
    description: "Gold-plated rings set",
    imageUrl: "assets/images/stackingring.webp",
    category: "newArrival",
    details: {
      item: "Ring",
      color: "Yellow Gold",
      size: "10",
      weight: "3g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 9,
    name: "Gold Charm Necklace",
    price: 2200,
    description: "Gold necklace with leaf charm",
    imageUrl: "assets/images/gold_chain_necklace.webp",
    category: "all",
    details: {
      item: "Necklace",
      color: "Yellow Gold",
      size: "18 inches",
      weight: "15g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 10,
    name: "Minimalist Bracelet",
    price: 1400,
    description: "Simple bracelet for daily wear",
    imageUrl: "assets/images/minimalist_bracelet.webp",
    category: "all",
    details: {
      item: "Bracelet",
      color: "Yellow Gold",
      size: "10 inches",
      weight: "7g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 11,
    name: "Pearl Drop Earrings",
    price: 1800,
    description: "Elegant pearl drop earrings",
    imageUrl: "assets/images/pearldropears.webp",
    category: "all",
    details: {
      item: "Earring",
      color: "Yellow Gold",
      size: "0.8 inches",
      weight: "7g",
      stones: "Natural Pearl",
      material: "18K Gold"
      }
  },
  {
    id: 12,
    name: "Stackable Rings Set",
    price: 1600,
    description: "Gold-plated rings set",
    imageUrl: "assets/images/stackingring.webp",
    category: "all",
    details: {
      item: "Ring",
      color: "Yellow Gold",
      size: "10",
      weight: "3g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 13,
    name: "Gold Charm Necklace",
    price: 2200,
    description: "Gold necklace with leaf charm",
    imageUrl: "assets/images/gold_chain_necklace.webp",
    category: "all",
    details: {
      item: "Necklace",
      color: "Yellow Gold",
      size: "18 inches",
      weight: "15g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 14,
    name: "Minimalist Bracelet",
    price: 1400,
    description: "Simple bracelet for daily wear",
    imageUrl: "assets/images/minimalist_bracelet.webp",
    category: "all",
    details: {
      item: "Bracelet",
      color: "Yellow Gold",
      size: "10 inches",
      weight: "7g",
      stones: "None",
      material: "18K Gold"
      }
  },
  {
    id: 15,
    name: "Pearl Drop Earrings",
    price: 1800,
    description: "Elegant pearl drop earrings",
    imageUrl: "assets/images/pearldropears.webp",
    category: "all",
    details: {
      item: "Earring",
      color: "Yellow Gold",
      size: "0.8 inches",
      weight: "7g",
      stones: "Natural Pearl",
      material: "18K Gold"
      }
  },
  {
    id: 16,
    name: "Stackable Rings Set",
    price: 1600,
    description: "Gold-plated rings set",
    imageUrl: "assets/images/stackingring.webp",
    category: "all",
    details: {
      item: "Ring",
      color: "Yellow Gold",
      size: "10",
      weight: "3g",
      stones: "None",
      material: "18K Gold"
      }
  }
];

// Main render function
function renderProducts(filterCategory = "all") {
  const container = document.getElementById("product-list");
  if (!container) return;

  // Filter products by category
  const filteredProducts =
    filterCategory === "all"
      ? products
      : products.filter(p => p.category === filterCategory);

  // Render product cards
  container.innerHTML = filteredProducts
    .map(
      p => `
      <div class="product" onclick="viewProduct(${p.id})">
      <img src="${p.imageUrl}" alt="${p.name}">
        <div class="info">
          <h3>${p.name}</h3>
          <p>${p.description}</p>
          <p class="price">$${p.price.toFixed(2)}</p>
          <button onclick="event.stopPropagation(); addToCart(${p.id})">Add to Cart</button>
        </div>
      </div>
    `
    )
    .join("");
}

// Product view handler
function viewProduct(productId) {
  const product = products.find(p => p.id === productId);
  if (!product) return;

  localStorage.setItem("selectedProduct", JSON.stringify(product));
  window.location.href = "product.html"; // navigate to product detail page
}

// Auto-detect which page is being loaded
document.addEventListener("DOMContentLoaded", () => {
  const page = window.location.pathname;

  if (page.includes("index.html") || page.includes("new-arrivals.html")) {
    renderProducts("newArrival");
  } else if (page.includes("collections.html")) {
    renderProducts("all");
  } else {
	renderProducts("newArrival");
  }
});

// Popup state
let modal = document.getElementById("imageModal");
let modalImg = document.getElementById("modalImage");
let closeBtn = document.querySelector(".close");
let prevBtn = document.getElementById("prevBtn");
let nextBtn = document.getElementById("nextBtn");

let currentCategoryImages = [];
let currentIndex = 0;

// Function to open modal by category
function openCategoryGallery(categoryName) {
  // Filter products matching category (case-insensitive)
  currentCategoryImages = products
    .filter(p => p.details.item.toLowerCase() === categoryName.toLowerCase())
    .map(p => p.imageUrl);

  if (currentCategoryImages.length === 0) return;

  currentIndex = 0;
  modal.style.display = "block";
  modalImg.src = currentCategoryImages[currentIndex];
}

// Next / Prev handlers
function showNextImage() {
  currentIndex = (currentIndex + 1) % currentCategoryImages.length;
  modalImg.src = currentCategoryImages[currentIndex];
}

function showPrevImage() {
  currentIndex = (currentIndex - 1 + currentCategoryImages.length) % currentCategoryImages.length;
  modalImg.src = currentCategoryImages[currentIndex];
}

// Close modal
closeBtn.onclick = () => (modal.style.display = "none");
window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };
nextBtn.onclick = showNextImage;
prevBtn.onclick = showPrevImage;

